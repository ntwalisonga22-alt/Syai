<div class="modal-content" onclick="event.stopPropagation()">
    <h3>THEME COLOR</h3>
    <div class="color-grid">
        <div class="color-dot" style="background: #00ff88;" onclick="setTheme('#00ff88')"></div>
        <div class="color-dot" style="background: #00d9ff;" onclick="setTheme('#00d9ff')"></div>
        <div class="color-dot" style="background: #ff0077;" onclick="setTheme('#ff0077')"></div>
    </div>

    <h3 style="margin-top:25px;">SYAI BRAIN</h3>
    <select id="model-select" onchange="saveModel()" style="width:100%; padding:10px; background:#333; color:white; border-radius:8px; border:1px solid var(--primary-color);">
        <option value="gemini-1.5-flash">Flash (Fast & Free)</option>
        <option value="gemini-1.5-pro">Pro (Smartest/Coding)</option>
    </select>
    
    <p style="font-size: 0.6rem; color: #666; margin-top: 15px;">Pro has stricter free limits than Flash.</p>
</div>

<script>
    // 1. Load saved model on startup
    let currentModel = localStorage.getItem('syai-model') || 'gemini-1.5-flash';
    document.getElementById('model-select').value = currentModel;

    function saveModel() {
        currentModel = document.getElementById('model-select').value;
        localStorage.setItem('syai-model', currentModel);
    }

    // 2. Update the sendMessage function to send the model name
    async function sendMessage() {
        if (isCooldown) return;
        const input = document.getElementById('user-input');
        const container = document.getElementById('chat-container');
        const loader = document.getElementById('loading');
        const msgText = input.value.trim();

        if (!msgText) return;

        container.innerHTML += `<div class="msg user-msg">${msgText}</div>`;
        input.value = '';
        container.scrollTop = container.scrollHeight;
        loader.style.display = 'block';

        try {
            const response = await fetch('/api/chat', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    message: msgText,
                    model: currentModel // <--- NEW: Sends the selected model
                })
            });
            
            const data = await response.json();
            loader.style.display = 'none';
            
            if (data.errorType === "QUOTA") { startCooldown(data.cooldownTime); }

            container.innerHTML += `<div class="msg ai-msg">${data.reply}</div>`;
            container.scrollTop = container.scrollHeight;
        } catch (e) {
            loader.style.display = 'none';
            container.innerHTML += `<div class="msg ai-msg">Interface Error.</div>`;
        }
    }
    
    // ... rest of your existing theme/cooldown scripts ...
</script>
